{"timestamp":"2026-02-22T11:11:23.097046Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-22T11:11:23.097523Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/weather_dag.py","logger":"airflow.models.dagbag.BundleDagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-22T11:11:23.109127Z","level":"info","event":"â†’ Conectando em postgres:5432/weather_data","logger":"root","filename":"load_data.py","lineno":22}
{"timestamp":"2026-02-22T11:11:23.116627Z","level":"warning","event":"The `airflow.decorators.dag` attribute is deprecated. Please use `'airflow.sdk.dag'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/weather_dag.py","lineno":2,"logger":"py.warnings"}
{"timestamp":"2026-02-22T11:11:23.116774Z","level":"warning","event":"The `airflow.decorators.task` attribute is deprecated. Please use `'airflow.sdk.task'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/weather_dag.py","lineno":2,"logger":"py.warnings"}
{"timestamp":"2026-02-22T11:11:23.134109Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.134222Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.134303Z","level":"info","event":"Current task name:load","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.134355Z","level":"info","event":"Dag name:weather_pipeline","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.249722Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1142,"error_detail":[{"exc_type":"IntegrityError","exc_value":"(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(sp_weather, 2200) already exists.\n\n[SQL: \nCREATE TABLE sp_weather (\n\tbase TEXT, \n\tvisibility BIGINT, \n\tdatetime TIMESTAMP WITH TIME ZONE, \n\ttimezone BIGINT, \n\tcity_id BIGINT, \n\tcity_name TEXT, \n\tcode BIGINT, \n\tlongitude FLOAT(53), \n\tlatitude FLOAT(53), \n\ttemperature FLOAT(53), \n\tfeels_like FLOAT(53), \n\ttemp_min FLOAT(53), \n\ttemp_max FLOAT(53), \n\tpressure BIGINT, \n\thumidity BIGINT, \n\tsea_level BIGINT, \n\tgrnd_level BIGINT, \n\twind_speed FLOAT(53), \n\twind_deg BIGINT, \n\t\"rain.1h\" FLOAT(53), \n\tclouds BIGINT, \n\tsys_id BIGINT, \n\tcountry TEXT, \n\tsunrise TIMESTAMP WITH TIME ZONE, \n\tsunset TIMESTAMP WITH TIME ZONE, \n\tweather_id BIGINT, \n\tweather_main TEXT, \n\tweather_description TEXT\n)\n\n]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1068,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1477,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":417,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":252,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":417,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":228,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":251,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/weather_dag.py","lineno":51,"name":"load"},{"filename":"/opt/airflow/src/load_data.py","lineno":30,"name":"load_weather_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py","lineno":333,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py","lineno":3109,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":844,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":2020,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1924,"name":"prep_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":997,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":983,"name":"_execute_create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py","lineno":1288,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2467,"name":"_run_ddl_visitor"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py","lineno":661,"name":"traverse_single"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":1022,"name":"visit_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":321,"name":"_invoke_with"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1419,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":187,"name":"_execute_on_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1530,"name":"_execute_ddl"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1846,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1986,"name":"_exec_single_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2363,"name":"_handle_dbapi_exception"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1967,"name":"_exec_single_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":952,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"UniqueViolation","exc_value":"duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(sp_weather, 2200) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1967,"name":"_exec_single_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":952,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-22T11:11:23.276029Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276239Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276339Z","level":"info","event":"Task:<Task(_PythonDecoratedOperator): load>","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276394Z","level":"info","event":"Failure caused by (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276432Z","level":"info","event":"DETAIL:  Key (typname, typnamespace)=(sp_weather, 2200) already exists.","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276468Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276502Z","level":"info","event":"[SQL:","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276530Z","level":"info","event":"CREATE TABLE sp_weather (","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276571Z","level":"info","event":"\tbase TEXT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276604Z","level":"info","event":"\tvisibility BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276625Z","level":"info","event":"\tdatetime TIMESTAMP WITH TIME ZONE,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276648Z","level":"info","event":"\ttimezone BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276669Z","level":"info","event":"\tcity_id BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276689Z","level":"info","event":"\tcity_name TEXT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276709Z","level":"info","event":"\tcode BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276728Z","level":"info","event":"\tlongitude FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276747Z","level":"info","event":"\tlatitude FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276767Z","level":"info","event":"\ttemperature FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276788Z","level":"info","event":"\tfeels_like FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276807Z","level":"info","event":"\ttemp_min FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276841Z","level":"info","event":"\ttemp_max FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276881Z","level":"info","event":"\tpressure BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276907Z","level":"info","event":"\thumidity BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276928Z","level":"info","event":"\tsea_level BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276947Z","level":"info","event":"\tgrnd_level BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276967Z","level":"info","event":"\twind_speed FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.276987Z","level":"info","event":"\twind_deg BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277006Z","level":"info","event":"\t\"rain.1h\" FLOAT(53),","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277026Z","level":"info","event":"\tclouds BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277045Z","level":"info","event":"\tsys_id BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277065Z","level":"info","event":"\tcountry TEXT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277088Z","level":"info","event":"\tsunrise TIMESTAMP WITH TIME ZONE,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277123Z","level":"info","event":"\tsunset TIMESTAMP WITH TIME ZONE,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277158Z","level":"info","event":"\tweather_id BIGINT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277192Z","level":"info","event":"\tweather_main TEXT,","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277232Z","level":"info","event":"\tweather_description TEXT","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277265Z","level":"info","event":")","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277299Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277360Z","level":"info","event":"]","logger":"task.stdout"}
{"timestamp":"2026-02-22T11:11:23.277419Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/20/gkpj)","logger":"task.stdout"}
